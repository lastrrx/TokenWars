<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TokenWars Admin Panel - Enhanced Token Management</title>
    <link rel="stylesheet" href="admin.css">
    
    <!-- Chart.js for analytics -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    
    <!-- Supabase Client -->
    <script src="https://unpkg.com/@supabase/supabase-js@2"></script>
    
    <style>
        /* Enhanced notification system */
        .admin-notification {
            position: fixed;
            top: 20px;
            right: 20px;
            background: rgba(31, 41, 55, 0.95);
            border: 1px solid;
            border-radius: 0.5rem;
            padding: 1rem 1.5rem;
            color: #f3f4f6;
            z-index: 4000;
            min-width: 300px;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.3);
            backdrop-filter: blur(10px);
            display: flex;
            justify-content: space-between;
            align-items: center;
            animation: slideIn 0.3s ease;
        }

        @keyframes slideIn {
            from { transform: translateX(100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }

        .admin-notification.success { border-color: #22c55e; }
        .admin-notification.error { border-color: #ef4444; }
        .admin-notification.warning { border-color: #f59e0b; }
        .admin-notification.info { border-color: #3b82f6; }

        .admin-notification button {
            background: none;
            border: none;
            color: #9ca3af;
            font-size: 1.2rem;
            cursor: pointer;
            margin-left: 1rem;
        }

        /* Enhanced system health indicators */
        .status-indicator.healthy { background: #22c55e; }
        .status-indicator.error { background: #ef4444; }
        .status-indicator.stale { background: #f59e0b; }
        .status-indicator.unavailable { background: #6b7280; }

        /* Enhanced token management styles */
        .token-compatibility-indicator {
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.25rem 0.75rem;
            border-radius: 1rem;
            font-size: 0.75rem;
            font-weight: 600;
        }

        .compatibility-excellent {
            background: rgba(34, 197, 94, 0.2);
            color: #22c55e;
        }

        .compatibility-good {
            background: rgba(59, 130, 246, 0.2);
            color: #3b82f6;
        }

        .compatibility-fair {
            background: rgba(245, 158, 11, 0.2);
            color: #f59e0b;
        }

        .compatibility-poor {
            background: rgba(239, 68, 68, 0.2);
            color: #ef4444;
        }

        /* Enhanced token blacklist management */
        .blacklist-section {
            background: rgba(239, 68, 68, 0.1);
            border: 1px solid rgba(239, 68, 68, 0.3);
            border-radius: 0.75rem;
            padding: 1.5rem;
            margin: 1rem 0;
        }

        .blacklist-title {
            color: #ef4444;
            font-weight: 600;
            margin-bottom: 1rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .blacklist-token {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0.75rem;
            background: rgba(15, 23, 42, 0.8);
            border-radius: 0.5rem;
            margin-bottom: 0.5rem;
        }

        /* Enhanced token validation indicators */
        .validation-indicator {
            display: inline-flex;
            align-items: center;
            gap: 0.25rem;
            font-size: 0.75rem;
        }

        .validation-pass {
            color: #22c55e;
        }

        .validation-fail {
            color: #ef4444;
        }

        .validation-warning {
            color: #f59e0b;
        }

        /* Enhanced price monitoring */
        .price-trend {
            display: inline-flex;
            align-items: center;
            gap: 0.25rem;
            font-size: 0.75rem;
            font-weight: 600;
        }

        .price-trend.up {
            color: #22c55e;
        }

        .price-trend.down {
            color: #ef4444;
        }

        .price-trend.stable {
            color: #6b7280;
        }

        /* Enhanced analytics cards */
        .analytics-insight {
            background: rgba(59, 130, 246, 0.1);
            border: 1px solid rgba(59, 130, 246, 0.3);
            border-radius: 0.75rem;
            padding: 1.5rem;
            margin: 1rem 0;
        }

        .insight-title {
            color: #3b82f6;
            font-weight: 600;
            margin-bottom: 0.5rem;
        }

        .insight-value {
            font-size: 1.25rem;
            font-weight: 700;
            color: #f3f4f6;
            margin-bottom: 0.25rem;
        }

        .insight-description {
            color: #9ca3af;
            font-size: 0.875rem;
        }

        /* Enhanced loading states */
        .loading-overlay {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(15, 23, 42, 0.8);
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 0.75rem;
            backdrop-filter: blur(5px);
        }

        .loading-spinner {
            width: 40px;
            height: 40px;
            border: 3px solid rgba(139, 92, 246, 0.3);
            border-top: 3px solid #8b5cf6;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* Enhanced token selection interface */
        .token-selection-preview {
            background: rgba(15, 23, 42, 0.8);
            border: 1px solid rgba(75, 85, 99, 0.3);
            border-radius: 0.75rem;
            padding: 1rem;
            margin: 1rem 0;
        }

        .preview-title {
            color: #8b5cf6;
            font-weight: 600;
            margin-bottom: 1rem;
        }

        .preview-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 1rem;
        }

        .preview-stat {
            text-align: center;
        }

        .preview-stat-label {
            color: #9ca3af;
            font-size: 0.75rem;
            margin-bottom: 0.25rem;
        }

        .preview-stat-value {
            color: #f3f4f6;
            font-weight: 600;
        }

        /* Enhanced error states */
        .error-state {
            background: rgba(239, 68, 68, 0.1);
            border: 1px solid rgba(239, 68, 68, 0.3);
            border-radius: 0.75rem;
            padding: 2rem;
            text-align: center;
            color: #ef4444;
        }

        .error-state h3 {
            margin-bottom: 0.5rem;
        }

        .error-state p {
            color: #9ca3af;
            margin-bottom: 1rem;
        }

        /* Enhanced real-time indicators */
        .real-time-indicator {
            display: inline-flex;
            align-items: center;
            gap: 0.25rem;
            padding: 0.25rem 0.5rem;
            background: rgba(34, 197, 94, 0.2);
            border: 1px solid rgba(34, 197, 94, 0.3);
            border-radius: 0.5rem;
            font-size: 0.75rem;
            color: #22c55e;
        }

        .real-time-pulse {
            width: 6px;
            height: 6px;
            background: #22c55e;
            border-radius: 50%;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0% { opacity: 1; }
            50% { opacity: 0.5; }
            100% { opacity: 1; }
        }

        /* Enhanced responsive design */
        @media (max-width: 1024px) {
            .token-stats-grid {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .preview-stats {
                grid-template-columns: repeat(2, 1fr);
            }
        }

        @media (max-width: 768px) {
            .admin-notification {
                right: 10px;
                left: 10px;
                min-width: auto;
            }
            
            .token-stats-grid {
                grid-template-columns: 1fr;
            }
            
            .preview-stats {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <!-- Admin Authentication Screen -->
    <div id="auth-screen" class="auth-container">
        <div class="auth-box">
            <h1>ğŸš€ TokenWars Admin Panel</h1>
            <p class="auth-description">Enhanced Token Management & Competition Control</p>
            
            <div class="auth-steps">
                <div class="auth-step" id="step-wallet">
                    <div class="step-number">1</div>
                    <div class="step-content">
                        <h3>Connect Admin Wallet</h3>
                        <button id="connect-admin-wallet" class="btn btn-primary">
                            Connect Wallet
                        </button>
                        <div id="wallet-status" class="wallet-status hidden">
                            <span class="wallet-address"></span>
                            <span class="status-icon">âœ“</span>
                        </div>
                    </div>
                </div>
                
                <div class="auth-step disabled" id="step-pin">
                    <div class="step-number">2</div>
                    <div class="step-content">
                        <h3>Enter Admin PIN</h3>
                        <input type="password" id="admin-pin" placeholder="Enter 6-digit PIN" 
                               maxlength="6" pattern="[0-9]{6}" disabled>
                        <button id="verify-pin" class="btn btn-primary" disabled>
                            Verify Access
                        </button>
                    </div>
                </div>
            </div>
            
            <div id="auth-error" class="error-message hidden"></div>
        </div>
    </div>

    <!-- Main Admin Panel -->
    <div id="admin-panel" class="admin-panel hidden">
        <!-- Enhanced Admin Header -->
        <header class="admin-header">
            <div class="header-container">
                <h1>ğŸ† TokenWars Admin - Enhanced Token Management</h1>
                <div class="header-actions">
                    <div class="real-time-indicator">
                        <div class="real-time-pulse"></div>
                        <span>Live Data</span>
                    </div>
                    <div id="token-update-status" class="token-update-status">
                        <span class="status-indicator"></span>
                        <span>Token Status: Loading...</span>
                    </div>
                    <span class="admin-wallet"></span>
                    <button id="logout" class="btn btn-secondary">Logout</button>
                </div>
            </div>
        </header>

        <!-- Enhanced Admin Navigation -->
        <nav class="admin-nav">
            <ul class="nav-menu">
                <li><a href="#dashboard" class="nav-item active">ğŸ“Š Dashboard</a></li>
                <li><a href="#competitions" class="nav-item">ğŸ Competitions</a></li>
                <li><a href="#tokens" class="nav-item">ğŸª™ Token Management</a></li>
                <li><a href="#users" class="nav-item">ğŸ‘¥ Users</a></li>
                <li><a href="#analytics" class="nav-item">ğŸ“ˆ Analytics</a></li>
                <li><a href="#settings" class="nav-item">âš™ï¸ Settings</a></li>
            </ul>
        </nav>

        <!-- Enhanced Admin Content -->
        <main class="admin-content">
            <!-- Enhanced Dashboard Section -->
            <section id="dashboard" class="admin-section">
                <h2>ğŸ›ï¸ System Dashboard</h2>
                
                <!-- Enhanced Key Metrics -->
                <div class="metrics-grid" id="dashboard-metrics">
                    <div class="metric-card">
                        <h3>ğŸ’° Total Volume</h3>
                        <p class="metric-value" id="total-volume">0 SOL</p>
                        <p class="metric-change positive">+12.5%</p>
                    </div>
                    <div class="metric-card">
                        <h3>ğŸƒ Active Competitions</h3>
                        <p class="metric-value" id="active-competitions">0</p>
                        <p class="metric-change positive">+5.2%</p>
                    </div>
                    <div class="metric-card">
                        <h3>ğŸª™ Total Tokens</h3>
                        <p class="metric-value" id="total-tokens">0</p>
                        <p class="metric-change positive">+8.7%</p>
                    </div>
                    <div class="metric-card">
                        <h3>âœ… Active Tokens</h3>
                        <p class="metric-value" id="active-tokens">0</p>
                        <p class="metric-change">Real-time</p>
                    </div>
                    <div class="metric-card">
                        <h3>ğŸ“Š Total Market Cap</h3>
                        <p class="metric-value" id="total-market-cap">$0</p>
                        <p class="metric-change positive">+15.3%</p>
                    </div>
                    <div class="metric-card">
                        <h3>ğŸ”„ Price Updates (24h)</h3>
                        <p class="metric-value" id="recent-price-updates">0</p>
                        <p class="metric-change neutral">Auto-updating</p>
                    </div>
                </div>

                <!-- Enhanced System Status -->
                <div class="system-status">
                    <h3>ğŸ”§ System Health Status</h3>
                    <div class="status-grid">
                        <div class="status-item">
                            <span class="status-indicator healthy" id="token-service-status"></span>
                            <span>Token Service</span>
                        </div>
                        <div class="status-item">
                            <span class="status-indicator healthy" id="price-service-status"></span>
                            <span>Price Service</span>
                        </div>
                        <div class="status-item">
                            <span class="status-indicator healthy" id="competition-manager-status"></span>
                            <span>Competition Manager</span>
                        </div>
                        <div class="status-item">
                            <span class="status-indicator healthy" id="database-status"></span>
                            <span>Database</span>
                        </div>
                        <div class="status-item">
                            <span class="status-indicator healthy" id="price-updates-status"></span>
                            <span>Price Updates</span>
                        </div>
                    </div>
                </div>

                <!-- Enhanced Analytics Insights -->
                <div class="analytics-insights">
                    <h3>ğŸ“ˆ Key Insights</h3>
                    <div class="insights-grid">
                        <div class="analytics-insight">
                            <div class="insight-title">ğŸ¯ Token Pair Success Rate</div>
                            <div class="insight-value" id="pair-success-rate">94.2%</div>
                            <div class="insight-description">Automated pairs performing well</div>
                        </div>
                        <div class="analytics-insight">
                            <div class="insight-title">âš¡ Average Competition Duration</div>
                            <div class="insight-value" id="avg-competition-duration">23.4h</div>
                            <div class="insight-description">Optimal engagement window</div>
                        </div>
                        <div class="analytics-insight">
                            <div class="insight-title">ğŸ”„ Token Refresh Rate</div>
                            <div class="insight-value" id="token-refresh-rate">98.7%</div>
                            <div class="insight-description">High data reliability</div>
                        </div>
                    </div>
                </div>

                <!-- Enhanced Recent Activity -->
                <div class="recent-activity">
                    <h3>ğŸ“ Recent Activity</h3>
                    <div id="activity-feed" class="activity-feed">
                        <!-- Activity items will be loaded here -->
                    </div>
                </div>
            </section>

            <!-- Enhanced Token Management Section -->
            <section id="tokens" class="admin-section hidden">
                <h2>ğŸª™ Enhanced Token Management</h2>
                
                <!-- Enhanced Token Statistics -->
                <div class="tokens-section">
                    <h3>ğŸ“Š Real-Time Token Statistics</h3>
                    <div class="token-stats-grid">
                        <div class="token-stat-card">
                            <div class="token-stat-value" id="total-tokens-stat">0</div>
                            <div class="token-stat-label">Total Tokens</div>
                        </div>
                        <div class="token-stat-card">
                            <div class="token-stat-value" id="active-tokens-stat">0</div>
                            <div class="token-stat-label">Active Tokens</div>
                        </div>
                        <div class="token-stat-card">
                            <div class="token-stat-value" id="verified-tokens-stat">0</div>
                            <div class="token-stat-label">Verified Tokens</div>
                        </div>
                        <div class="token-stat-card">
                            <div class="token-stat-value" id="total-market-cap-stat">$0</div>
                            <div class="token-stat-label">Total Market Cap</div>
                        </div>
                        <div class="token-stat-card">
                            <div class="token-stat-value" id="avg-liquidity-stat">0%</div>
                            <div class="token-stat-label">Avg Liquidity</div>
                        </div>
                        <div class="token-stat-card">
                            <div class="token-stat-value" id="blacklisted-tokens-stat">0</div>
                            <div class="token-stat-label">Blacklisted</div>
                        </div>
                    </div>
                </div>

                <!-- Enhanced Token Controls -->
                <div class="tokens-section">
                    <h3>ğŸ› ï¸ Token Management Controls</h3>
                    <div class="token-controls">
                        <input type="text" id="token-search" class="token-search" 
                               placeholder="ğŸ” Search tokens by symbol, name, or address...">
                        <button id="refresh-tokens-btn" class="btn btn-primary">
                            ğŸ”„ Refresh All Tokens
                        </button>
                        <button id="generate-pairs-btn" class="btn btn-secondary">
                            âš¡ Generate Smart Pairs
                        </button>
                        <button id="validate-tokens-btn" class="btn btn-warning">
                            âœ… Validate All Tokens
                        </button>
                    </div>
                    
                    <!-- Enhanced Tokens Table -->
                    <div class="table-container" id="tokens-table">
                        <table class="admin-table">
                            <thead>
                                <tr>
                                    <th>ğŸª™ Token</th>
                                    <th>ğŸ’° Price</th>
                                    <th>ğŸ“Š Market Cap</th>
                                    <th>ğŸ“… Age</th>
                                    <th>ğŸ’§ Liquidity</th>
                                    <th>ğŸ”„ Status</th>
                                    <th>âœ… Verification</th>
                                    <th>ğŸ•’ Updated</th>
                                    <th>ğŸ› ï¸ Actions</th>
                                </tr>
                            </thead>
                            <tbody id="tokens-tbody">
                                <!-- Token rows will be loaded here -->
                            </tbody>
                        </table>
                    </div>
                </div>

                <!-- Enhanced Token Blacklist Management -->
                <div class="blacklist-section">
                    <div class="blacklist-title">
                        ğŸš« Token Blacklist Management
                    </div>
                    <div id="blacklist-container">
                        <div class="blacklist-controls">
                            <input type="text" id="blacklist-address" placeholder="Token address to blacklist...">
                            <input type="text" id="blacklist-reason" placeholder="Reason for blacklisting...">
                            <button class="btn btn-danger" onclick="addTokenToBlacklist()">
                                Add to Blacklist
                            </button>
                        </div>
                        <div id="blacklist-list">
                            <!-- Blacklisted tokens will be shown here -->
                        </div>
                    </div>
                </div>

                <!-- Enhanced Token Pairs Section -->
                <div class="tokens-section token-pairs-section">
                    <h3>ğŸ”— Smart Token Pairs</h3>
                    <div class="token-pairs-controls">
                        <button class="btn btn-primary" onclick="generateCompatiblePairs()">
                            ğŸ¯ Generate Compatible Pairs
                        </button>
                        <button class="btn btn-secondary" onclick="validateAllPairs()">
                            âœ… Validate All Pairs
                        </button>
                    </div>
                    <div id="token-pairs-container" class="token-pairs-container">
                        <!-- Token pair cards will be loaded here -->
                    </div>
                </div>
            </section>

            <!-- Enhanced Competitions Management Section -->
            <section id="competitions" class="admin-section hidden">
                <h2>ğŸ Enhanced Competition Management</h2>
                
                <!-- Enhanced Create Competition -->
                <div class="create-competition">
                    <h3>âœ¨ Create New Competition</h3>
                    <form id="create-competition-form" class="competition-form">
                        <div class="form-row">
                            <div class="form-group">
                                <label>ğŸ¯ Token Selection Method</label>
                                <select id="selection-method" required>
                                    <option value="automatic">ğŸ¤– Automatic (AI Algorithm)</option>
                                    <option value="manual">ğŸ‘¨â€ğŸ’¼ Manual Selection</option>
                                    <option value="pair">ğŸ”— From Generated Pairs</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label>ğŸ•’ Start Time</label>
                                <input type="datetime-local" id="start-time" required>
                            </div>
                        </div>
                        
                        <!-- Enhanced Automatic Selection Info -->
                        <div id="automatic-selection-info" class="automatic-selection-info">
                            <div class="auto-selection-title">ğŸ¤– AI-Powered Token Selection Features</div>
                            <div class="auto-selection-features">
                                <div class="auto-feature">
                                    <span class="auto-feature-icon">âœ…</span>
                                    <span>Market cap matching (Â±10% tolerance)</span>
                                </div>
                                <div class="auto-feature">
                                    <span class="auto-feature-icon">âœ…</span>
                                    <span>Minimum 30-day token age validation</span>
                                </div>
                                <div class="auto-feature">
                                    <span class="auto-feature-icon">âœ…</span>
                                    <span>Liquidity score optimization</span>
                                </div>
                                <div class="auto-feature">
                                    <span class="auto-feature-icon">âœ…</span>
                                    <span>Real-time price data verification</span>
                                </div>
                                <div class="auto-feature">
                                    <span class="auto-feature-icon">âœ…</span>
                                    <span>Blacklist filtering</span>
                                </div>
                                <div class="auto-feature">
                                    <span class="auto-feature-icon">âœ…</span>
                                    <span>Compatibility scoring</span>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Enhanced Manual Token Selection -->
                        <div id="manual-token-selection" class="manual-token-selection hidden">
                            <h4>ğŸ¯ Select Token Pair Manually</h4>
                            <div class="token-selection-grid">
                                <div class="token-selection-slot" id="selected-token-a">
                                    <button type="button" class="btn btn-primary" onclick="openTokenSelector('A')">
                                        Select Token A
                                    </button>
                                </div>
                                <div class="vs-divider">âš¡ VS âš¡</div>
                                <div class="token-selection-slot" id="selected-token-b">
                                    <button type="button" class="btn btn-primary" onclick="openTokenSelector('B')">
                                        Select Token B
                                    </button>
                                </div>
                            </div>
                            
                            <!-- Token Selection Preview -->
                            <div id="token-selection-preview" class="token-selection-preview hidden">
                                <div class="preview-title">ğŸ“Š Token Pair Analysis</div>
                                <div class="preview-stats">
                                    <div class="preview-stat">
                                        <div class="preview-stat-label">Market Cap Difference</div>
                                        <div class="preview-stat-value" id="market-cap-diff">-</div>
                                    </div>
                                    <div class="preview-stat">
                                        <div class="preview-stat-label">Compatibility Score</div>
                                        <div class="preview-stat-value" id="compatibility-score">-</div>
                                    </div>
                                    <div class="preview-stat">
                                        <div class="preview-stat-label">Age Difference</div>
                                        <div class="preview-stat-value" id="age-diff">-</div>
                                    </div>
                                    <div class="preview-stat">
                                        <div class="preview-stat-label">Liquidity Match</div>
                                        <div class="preview-stat-value" id="liquidity-match">-</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="form-row">
                            <div class="form-group">
                                <label>â±ï¸ Duration (hours)</label>
                                <input type="number" id="duration" value="24" min="1" max="168" required>
                            </div>
                            <div class="form-group">
                                <label>ğŸ’° Bet Amount (SOL)</label>
                                <input type="number" id="bet-amount" value="0.1" min="0.01" step="0.01" required>
                            </div>
                        </div>
                        
                        <div class="form-row">
                            <div class="form-group">
                                <label>ğŸ’¸ Platform Fee (%)</label>
                                <input type="number" id="platform-fee" value="15" min="0" max="50" step="0.1" required>
                            </div>
                            <div class="form-group">
                                <label>ğŸ“Š Market Cap Range</label>
                                <select id="market-cap-range">
                                    <option value="5-50">$5M - $50M</option>
                                    <option value="50-250">$50M - $250M</option>
                                    <option value="250-1000">$250M - $1B</option>
                                    <option value="1000+">$1B+</option>
                                </select>
                            </div>
                        </div>
                        
                        <button type="submit" class="btn btn-primary">ğŸš€ Create Competition</button>
                    </form>
                </div>

                <!-- Enhanced Active Competitions -->
                <div class="competitions-list">
                    <h3>ğŸƒ Active Competitions</h3>
                    <div class="table-container">
                        <table class="admin-table">
                            <thead>
                                <tr>
                                    <th>ğŸ†” ID</th>
                                    <th>ğŸª™ Tokens</th>
                                    <th>ğŸ“Š Status</th>
                                    <th>ğŸ‘¥ Participants</th>
                                    <th>ğŸ’° Pool Size</th>
                                    <th>â° End Time</th>
                                    <th>ğŸ¤– Type</th>
                                    <th>ğŸ› ï¸ Actions</th>
                                </tr>
                            </thead>
                            <tbody id="competitions-tbody">
                                <!-- Competition rows will be loaded here -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </section>

            <!-- Enhanced Users Management Section -->
            <section id="users" class="admin-section hidden">
                <h2>ğŸ‘¥ User Management</h2>
                
                <!-- Enhanced User Search -->
                <div class="user-search">
                    <input type="text" id="user-search-input" 
                           placeholder="ğŸ” Search by wallet address or username">
                    <button class="btn btn-primary" onclick="searchUsers()">Search</button>
                </div>

                <!-- Enhanced Users Table -->
                <div class="users-list">
                    <div class="table-container">
                        <table class="admin-table">
                            <thead>
                                <tr>
                                    <th>ğŸ‘› Wallet</th>
                                    <th>ğŸ‘¤ Username</th>
                                    <th>ğŸ² Total Bets</th>
                                    <th>ğŸ† Win Rate</th>
                                    <th>ğŸ’° Total Volume</th>
                                    <th>ğŸ“… Joined</th>
                                    <th>ğŸ› ï¸ Actions</th>
                                </tr>
                            </thead>
                            <tbody id="users-tbody">
                                <!-- User rows will be loaded here -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </section>

            <!-- Enhanced Analytics Section -->
            <section id="analytics" class="admin-section hidden">
                <h2>ğŸ“ˆ Advanced Platform Analytics</h2>
                
                <!-- Enhanced Analytics Controls -->
                <div class="analytics-controls">
                    <select id="analytics-period">
                        <option value="24h">Last 24 Hours</option>
                        <option value="7d">Last 7 Days</option>
                        <option value="30d">Last 30 Days</option>
                        <option value="all">All Time</option>
                    </select>
                    <button class="btn btn-secondary" onclick="exportAnalytics()">
                        ğŸ“Š Export Data
                    </button>
                    <button class="btn btn-primary" onclick="refreshAnalytics()">
                        ğŸ”„ Refresh Analytics
                    </button>
                </div>

                <!-- Enhanced Charts Grid -->
                <div class="charts-grid">
                    <div class="chart-container">
                        <h3>ğŸ“Š Volume Over Time</h3>
                        <canvas id="volume-chart"></canvas>
                    </div>
                    <div class="chart-container">
                        <h3>ğŸ‘¥ User Growth</h3>
                        <canvas id="users-chart"></canvas>
                    </div>
                    <div class="chart-container">
                        <h3>ğŸª™ Token Performance</h3>
                        <canvas id="token-chart"></canvas>
                    </div>
                    <div class="chart-container">
                        <h3>ğŸ Competition Statistics</h3>
                        <canvas id="competition-chart"></canvas>
                    </div>
                </div>

                <!-- Enhanced Analytics Summary -->
                <div class="analytics-summary">
                    <h3>ğŸ¯ Key Performance Insights</h3>
                    <div id="insights-container">
                        <!-- Insights will be loaded here -->
                    </div>
                </div>
            </section>

            <!-- Enhanced Settings Section -->
            <section id="settings" class="admin-section hidden">
                <h2>âš™ï¸ Enhanced Platform Settings</h2>
                
                <!-- Enhanced Platform Configuration -->
                <div class="settings-group">
                    <h3>ğŸ”§ Platform Configuration</h3>
                    <form id="platform-settings-form">
                        <div class="form-group">
                            <label>ğŸ’¸ Platform Fee (%)</label>
                            <input type="number" id="platform-fee-setting" value="15" min="0" max="50" step="0.1">
                        </div>
                        <div class="form-group">
                            <label>ğŸ’° Default Bet Amount (SOL)</label>
                            <input type="number" id="bet-amount-setting" value="0.1" min="0.01" step="0.01">
                        </div>
                        <div class="form-group">
                            <label>â±ï¸ Default Competition Duration (hours)</label>
                            <input type="number" id="default-duration" value="24" min="1" max="168">
                        </div>
                        <div class="form-group">
                            <label>ğŸ‘› Platform Wallet</label>
                            <input type="text" id="platform-wallet" placeholder="Platform wallet address">
                        </div>
                        <div class="form-group">
                            <label>ğŸ”„ Token Update Frequency (hours)</label>
                            <input type="number" id="token-update-frequency" value="2" min="1" max="24">
                        </div>
                        <button type="submit" class="btn btn-primary">ğŸ’¾ Save Settings</button>
                    </form>
                </div>

                <!-- Enhanced Token Management Settings -->
                <div class="settings-group">
                    <h3>ğŸª™ Token Management Settings</h3>
                    <div class="form-group">
                        <label>ğŸ’° Minimum Market Cap (USD)</label>
                        <input type="number" id="min-market-cap" value="5000000" min="1000000">
                    </div>
                    <div class="form-group">
                        <label>ğŸ“… Minimum Token Age (days)</label>
                        <input type="number" id="min-token-age" value="30" min="1">
                    </div>
                    <div class="form-group">
                        <label>ğŸ“Š Market Cap Tolerance (%)</label>
                        <input type="number" id="market-cap-tolerance" value="10" min="1" max="50">
                    </div>
                    <div class="form-group">
                        <label>ğŸ’§ Minimum Liquidity Score</label>
                        <input type="number" id="min-liquidity-score" value="0.3" min="0" max="1" step="0.1">
                    </div>
                    <div class="form-group">
                        <label>ğŸ”„ Price Update Interval (minutes)</label>
                        <input type="number" id="price-update-interval" value="1" min="1" max="60">
                    </div>
                </div>

                <!-- Enhanced Emergency Controls -->
                <div class="settings-group danger-zone">
                    <h3>ğŸš¨ Emergency Controls</h3>
                    <p class="warning-text">âš ï¸ Use these controls only in emergency situations</p>
                    <div class="emergency-controls">
                        <button class="btn btn-danger" onclick="pausePlatform()">
                            â¸ï¸ Pause All Competitions
                        </button>
                        <button class="btn btn-danger" onclick="emergencyWithdraw()">
                            ğŸ’¸ Enable Emergency Withdrawals
                        </button>
                        <button class="btn btn-warning" onclick="refreshAllTokens()">
                            ğŸ”„ Force Token Refresh
                        </button>
                        <button class="btn btn-warning" onclick="clearAllPairs()">
                            ğŸ—‘ï¸ Clear All Token Pairs
                        </button>
                    </div>
                </div>
            </section>
        </main>
    </div>

    <!-- Enhanced Token Selector Modal -->
    <div id="token-selector-modal" class="token-selector-modal hidden">
        <div class="token-selector-content">
            <div class="token-selector-header">
                <h3 id="token-selector-title">ğŸ¯ Select Token</h3>
                <button class="close-modal" onclick="closeTokenSelector()">&times;</button>
            </div>
            
            <div class="token-search-container">
                <input type="text" id="token-selector-search" class="token-search" 
                       placeholder="ğŸ” Search tokens by symbol, name, or address...">
                <div class="token-filters">
                    <label><input type="checkbox" id="filter-verified"> âœ… Verified Only</label>
                    <label><input type="checkbox" id="filter-high-liquidity"> ğŸ’§ High Liquidity</label>
                </div>
            </div>
            
            <div id="token-selector-list" class="token-selector-list">
                <!-- Token selector items will be loaded here -->
            </div>
        </div>
    </div>

    <!-- Loading Overlay Template -->
    <div id="loading-template" class="loading-overlay hidden">
        <div class="loading-spinner"></div>
    </div>

    <!-- Scripts -->
    <script src="auth.js"></script>
    <script src="../config.js"></script>
    <script src="../supabase-client.js"></script>
    <script src="../token-service.js"></script>
    <script src="../price-service.js"></script>
    <script src="../competition-manager.js"></script>
    <script src="admin.js"></script>
    
    <script>
        // Enhanced helper functions for the admin interface
        function closeTokenSelector() {
            document.getElementById('token-selector-modal').classList.add('hidden');
        }
        
        function addTokenToBlacklist() {
            const address = document.getElementById('blacklist-address').value;
            const reason = document.getElementById('blacklist-reason').value;
            
            if (address && reason) {
                window.addTokenToBlacklist(address, reason);
                document.getElementById('blacklist-address').value = '';
                document.getElementById('blacklist-reason').value = '';
            }
        }
        
        function generateCompatiblePairs() {
            window.generateTokenPairs();
        }
        
        function validateAllPairs() {
            // Implementation for validating all token pairs
            console.log('Validating all token pairs...');
        }
        
        function validateAllTokens() {
            // Implementation for validating all tokens
            console.log('Validating all tokens...');
        }
        
        function pausePlatform() {
            if (confirm('âš ï¸ Are you sure you want to pause all competitions?')) {
                console.log('Pausing platform...');
            }
        }
        
        function emergencyWithdraw() {
            if (confirm('âš ï¸ Are you sure you want to enable emergency withdrawals?')) {
                console.log('Enabling emergency withdrawals...');
            }
        }
        
        function refreshAllTokens() {
            if (confirm('ğŸ”„ Force refresh all token data?')) {
                window.refreshTokensData();
            }
        }
        
        function clearAllPairs() {
            if (confirm('ğŸ—‘ï¸ Are you sure you want to clear all token pairs?')) {
                console.log('Clearing all token pairs...');
            }
        }
        
        function exportAnalytics() {
            console.log('Exporting analytics data...');
        }
        
        function refreshAnalytics() {
            console.log('Refreshing analytics...');
        }
        
        function searchUsers() {
            const query = document.getElementById('user-search-input').value;
            console.log('Searching users:', query);
        }
    </script>
</body>
</html>
